# This configuration file was automatically generated by Gitpod.
# Please adjust to your needs (see https://www.gitpod.io/docs/config-gitpod-file)
# and commit this file to your remote git repository to share the goodness with others.
image:
  file: .gitpod.Dockerfile

ports:
  - port: 5555
    onOpen: open-preview


vscode:
  extensions:
    - yandeu.five-server
    - glenn2223.live-sass
    - kamikillerto.vscode-colorize
    - aaron-bond.better-comments
    - streetsidesoftware.code-spell-checker

tasks:
  - name: install pre-commit git hooks
    init: pre-commit install
  - name: open scss file
    command: |
      gp open Brandy/css.scss
      npx five-server --open="index.html"
  - name: start up buildkitd
    command: |
      sudo /usr/bin/buildkitd --debug  --config ./buildkitd.toml --group gitpod
  - name: start a local docker registry
    command: |
      mkdir -p /workspace/registry
      docker run -p 5000:5000 --name registry --rm -v /workspace/registry:/var/lib/registry registry:2
    openMode: split-right
  - name: dazzle build and test
    command: |
      gp ports await 5000
      REPO=localhost:5000/dazzle
    openMode: tab-after
  - init: npm install
  - name: Web Browser
    openMode: split-right
    #env:
    #  WEBSERVER_PORT: 5555
    #npx exec five-server
    command: |
      echo "Launching Web Server"
      npm install
      gp ports await 5555
      echo "Loading Browser"
      lynx `gp url $GITPOD_WORKSPACE_URL:$WEBSERVER_PORT/index.html`
      npx five-server --open="index.html"



github:
  prebuilds:
    # enable for the master/default branch (defaults to true)
    master: true
    # enable for all branches in this repo (defaults to false)
    branches: true
    # enable for pull requests coming from this repo (defaults to true)
    pullRequests: true
    # enable for pull requests coming from forks (defaults to false)
    pullRequestsFromForks: true
    # add a "Review in Gitpod" button as a comment to pull requests (defaults to true)
    addComment: true
    # add a "Review in Gitpod" button to pull requests (defaults to false)
    addBadge: true
    # add a label once the prebuild is ready to pull requests (defaults to false)
    addLabel: prebuilt-in-gitpod
